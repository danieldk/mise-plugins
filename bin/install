#!/usr/bin/env bash

install_neovim() {
  local build_path

  if [ "$ASDF_INSTALL_TYPE" = "version" ]; then
    build_path="$ASDF_DOWNLOAD_PATH"

    mv -f "$build_path"/** "" 
  else
    (
      cd "$ASDF_DOWNLOAD_PATH"

      if [[ "$OSTYPE" == "linux-gnu" ]]; then
        make CMAKE_BUILD_TYPE=RelWithDebInfo CMAKE_EXTRA_FLAGS="-DCMAKE_INSTALL_PREFIX:PATH="
      else
        make CMAKE_BUILD_TYPE=Release \
             CMAKE_EXTRA_FLAGS="-DCMAKE_INSTALL_PREFIX:PATH="
      fi

      make DESTDIR="${ASDF_INSTALL_PATH}" install
    )
  fi

  rm -rf "$ASDF_DOWNLOAD_PATH"
}

install_neovim
